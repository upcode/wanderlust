{% extends "base.html" %}

{% block head %}

    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <script src="static/js/d3_world_map.js"></script>
      <script src="static/js/world.js"></script>

{% endblock %}

{% block title %}
{% endblock %}

{% block content %}
<style>


#list{
float:left;
}

#postcards {
float:right;
}
</style>

<!--LAYOUT FOR PROFILE PAGE -->
    <div class="container-fluid">
      <div class="row">
          <div class="col-xs-12 col-sm-6 col-md-8"></div><!-- .col-xs-12 .col-sm-6 .col-md-8-->
          <div class="col-xs-6 col-md-4"></div><!-- end .col-xs-6 .col-md-4-->
      </div><!--end row-->
    </div><!-- end container-->

   <!--
#################################################################
-->




<script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <script src="static/js/d3_world_map.js"></script>
<!--   d3 World Map that unreels into flat map
 -->
<div class="container-fluid">
    <div class="row">
         <div class="col-md-6 col-md-offset-1">

  <div id="map"></div>
  </div>
</div>
 <script>
// d3 world map javascript
// Map hight and width
var mapWidth = 860,
  mapHeight = 400,
  focused = false,
  ortho = true,
  sens = 0.25;
// world map projection
var projectionGlobe = d3.geo.orthographic()
  .scale(140)
  .center([0, 0])
  .translate([mapWidth / 2, mapHeight / 2])
  .clipAngle(90);
var projectionMap = d3.geo.equirectangular()
  .scale(145)
  .center([0, 0])
  .translate([mapWidth / 2, mapHeight / 2])
var projection = projectionGlobe;
var path = d3.geo.path()
  .projection(projection);
var globe2map = interpolatedProjection(projectionGlobe, projectionMap),
map2globe = interpolatedProjection(projectionMap, projectionGlobe);
var svgMap = d3.select("div#map").append("svg")
  .attr("overflow", "hidden")
  .attr("width", mapWidth)
  .attr("height", mapHeight);
// Tool Tip
var zoneTooltip = d3.select("div#map").append("div").attr("class", "zoneTooltip"),
pointLlabel = d3.select("div#map").append("div").attr("class", "pointLabel"),
infoLabel = d3.select("div#map").append("div").attr("class", "infoLabel");
var g = svgMap.append("g");
//Unreelling transformation
function animation(interProj) {
  defaultRotate();
  g.transition()
  .duration(7500)
  .tween("projection", function() {
    return function(_) {
      interProj.alpha(_);
      g.selectAll("path").attr("d", path);
    };
  })
}
function interpolatedProjection(a, b) {
  var projection = d3.geo.projection(raw).scale(1),
  center = projection.center,
  translate = projection.translate,
  clip = projection.clipAngle,
  α;
  function raw(λ, φ) {
    var pa = a([λ *= 180 / Math.PI, φ *= 180 / Math.PI]), pb = b([λ, φ]);
    return [(1 - α) * pa[0] + α * pb[0], (α - 1) * pa[1] - α * pb[1]];
  }
  projection.alpha = function(_) {
    if (!arguments.length) return α;
    α = +_;
    var ca = a.center(), cb = b.center(),
    ta = a.translate(), tb = b.translate();
    center([(1 - α) * ca[0] + α * cb[0], (1 - α) * ca[1] + α * cb[1]]);
    translate([(1 - α) * ta[0] + α * tb[0], (1 - α) * ta[1] + α * tb[1]]);
    if (ortho === true) {clip(180 - α * 90);}
    return projection;
  };
  delete projection.scale;
  delete projection.translate;
  delete projection.center;
  return projection.alpha(0);
}
//Rotate to default before animation
function defaultRotate() {
  d3.transition()
  .duration(1500)
  .tween("rotate", function() {
    var r = d3.interpolate(projection.rotate(), [0, 0]);
    return function(t) {
      projection.rotate(r(t));
      g.selectAll("path").attr("d", path);
    };
  })
};
//Starter for function AFTER All transitions
function endall(transition, callback) {
  var n = 0;
  transition
  .each(function() { ++n; })
  .each("end", function() { if (!--n) callback.apply(this, arguments); });
}
//Loading data
queue()
.defer(d3.json, "/static/d3mapdata/world-110m.json")
.defer(d3.tsv, "/static/d3mapdata/world-110m-country-names.tsv")
.await(ready);
function ready(error, world, countryData) {
  var countryById = {},
  countries = topojson.feature(world, world.objects.countries).features;
  //Adding countries by name
  countryData.forEach(function(d) {
    countryById[d.id] = d.name;
  });
  //Drawing countries on the globe
  var world = g.selectAll("path").data(countries);
  world.enter().append("path")
  .attr("class", "mapData")
  .attr("d", path)
  .classed("ortho", ortho = true);
  //Drag event
  world.call(d3.behavior.drag()
    .origin(function() { var r = projection.rotate(); return {x: r[0] / sens, y: -r[1] / sens}; })
    .on("drag", function() {
      var λ = d3.event.x * sens,
      φ = -d3.event.y * sens,
      rotate = projection.rotate();
      //Restriction for rotating upside-down
      φ = φ > 30 ? 30 :
      φ < -30 ? -30 :
      φ;
      projection.rotate([λ, φ]);
      g.selectAll("path.ortho").attr("d", path);
      g.selectAll(".focused").classed("focused", focused = false);
    }))
  //Events processing
  world.on("mouseover", function(d) {
    if (ortho === true) {
      infoLabel.text(countryById[d.id])
      .style("display", "inline");
    } else {
      zoneTooltip.text(countryById[d.id])
      .style("left", (d3.event.pageX + 7) + "px")
      .style("top", (d3.event.pageY - 15) + "px")
      .style("display", "block");
    }
  })
  .on("mouseout", function(d) {
    if (ortho === true) {
      infoLabel.style("display", "none");
    } else {
      zoneTooltip.style("display", "none");
    }
  })
  .on("mousemove", function() {
    if (ortho === false) {
      zoneTooltip.style("left", (d3.event.pageX + 7) + "px")
      .style("top", (d3.event.pageY - 15) + "px");
    }
  })
  .on("click", function(d) {
    if (focused === d) return reset();
    g.selectAll(".focused").classed("focused", false);
    d3.select(this).classed("focused", focused = d);
    infoLabel.text(countryById[d.id])
    .style("display", "inline");
    //Transforming Globe to Map
    if (ortho === true) {
      defaultRotate();
      setTimeout(function() {
        projection = globe2map;
        path.projection(projection);
        animation(projection);
        g.selectAll(".ortho").classed("ortho", ortho = false);
      }
      , 1600);
    }
  });
  //Adding extra data when focused
  function focus(d) {
    if (focused === d) return reset();
    g.selectAll(".focused").classed("focused", false);
    d3.select(this).classed("focused", focused = d);
  }
  //Reset projection
  function reset() {
    g.selectAll(".focused").classed("focused", focused = false);
    infoLabel.style("display", "none");
    zoneTooltip.style("display", "none");
    //Transforming Map to Globe
    projection = map2globe;
    path.projection(projection);
    animation(projection);
    g.selectAll("path").classed("ortho", ortho = true);
  }
};

</script>
<script>
// GOOGLE MAP

// This example displays an address form, using the autocomplete feature
// of the Google Places API to help users fill in the information.

var placeSearch, autocomplete;
var componentForm = {
  street_number: 'short_name',
  route: 'long_name',
  locality: 'long_name',
  administrative_area_level_1: 'short_name',
  country: 'long_name',
  postal_code: 'short_name'
};

function initAutocomplete() {
  // Create the autocomplete object, restricting the search to geographical
  // location types.
  autocomplete = new google.maps.places.Autocomplete(
      /** @type {!HTMLInputElement} */(document.getElementById('autocomplete')),
      {types: ['geocode']});

  // When the user selects an address from the dropdown, populate the address
  // fields in the form.
  autocomplete.addListener('place_changed', fillInAddress);
}

function fillInAddress() {
  // Get the place details from the autocomplete object.
  var place = autocomplete.getPlace();

  for (var component in componentForm) {
    document.getElementById(component).value = '';
    document.getElementById(component).disabled = false;
  }

  // Get each component of the address from the place details
  // and fill the corresponding field on the form.
  for (var i = 0; i < place.address_components.length; i++) {
    var addressType = place.address_components[i].types[0];
    if (componentForm[addressType]) {
      var val = place.address_components[i][componentForm[addressType]];
      document.getElementById(addressType).value = val;
    }
  }
}

// Bias the autocomplete object to the user's geographical location,
// as supplied by the browser's 'navigator.geolocation' object.
function geolocate() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var geolocation = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };
      var circle = new google.maps.Circle({
        center: geolocation,
        radius: position.coords.accuracy
      });
      autocomplete.setBounds(circle.getBounds());
    });
  }
}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyACeycrJBhijX_wyuGd8cGqo8VUIfT2Aww&signed_in=true&libraries=places&callback=initAutocomplete"
        async defer></script>

<!-- PROFILE PAGE-->
 <div class="container-fluid">
    <div class="row">
        <div class="col-xs-12 col-md-6">
            <div class="col-md-8">
                <div class="well well-sm">
                    <div class="media">
                        <a class="thumbnail pull-left" href="#" data-toggle="modal" data-target="#myModal" class="profilepicture">
                        <img class="media-object" src="static/img/uma.jpg">
                        </a>
                        <div class="media-body">
                        <h4 class="media-heading">Uma Petersen</h4>
                        <strong><small>World Traveler</small></strong><br>
                        <p>San Francisco, California</p>
                        <p>"future belongs to those who beleive in beauity of their dreams.er</p>

                                <p><span class="label label-info">10 photos</span> <span class="label label-primary">89 followers</span></p>
                        <p>
                            <a href="#" class="btn btn-xs btn-default"><span class="glyphicon glyphicon-star"></span>Countries</a>
                            <a href="#" class="btn btn-xs btn-default"><span class="glyphicon glyphicon-star"></span>States</a>
                            <a href="#" class="btn btn-xs btn-default"><span class="glyphicon glyphicon-star"></span>Capitols</a>
                             <a href="#" class="btn btn-xs btn-default"><span class="glyphicon glyphicon-star">Landmark</span></a>
                              <a href="#" class="btn btn-xs btn-default"><span class="glyphicon glyphicon-star">Wonders</span></a>
                        </p>
                    </div>
                </div>


                        <div class="well well-sm">
                  <div class="media">
                    <center><a class="thumbnail center" href="#">
                        <img class="media-object" src="static/img/adventurelist.png">
                        </a></center>
                          <div class="media-body">
                            <div class="col-md-7">
                              <h4 class="media-heading">Wanderlust List</h4>
                            <ul id="adventure-list">
                            {% for place in places %}
                              <li>{{place}}</li>
                            {% endfor %}

                          </ul>
                          <form id="newItemForm" action="/adventurelist">
                            <input type="text" id="itemDescription" name="addventurelist" placeholder="Add description" required />
                            <input type="submit" id="submit-button" value="add" title="Minmimum 1 letters or numbers." required/>
                        </form>
                            </div>
                          </div>
                    </div>
                  </div>
            </div>
        </div>
    </div>
    <script>
    // sending to my server
// created functon called add adventure using ajax call to submit users new item on the list to be stored in the sever.
// function addAdventure passed in evt
//use a post method to route to sever which is form action="/adventurelist"
// in order to pass info have to pass ajax as dictionary
// pass fucntionn dta

// method prepares the request and has three prams
  // method get or post
  // route path
  // data  form is sending
function addAdventure(evt) {
  evt.preventDefault();
  var new_item = $('#itemDescription').val();

  $.post('/adventurelist', {'place':new_item}, function (data){
    console.log(data);
    $('#adventure-list').append("<li>"+ new_item +"</li>");
  });
}
    </script>
<!--LIST-->


    <!-- Profile Modal -->
                <!-- <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                      <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <header><img src="/static/img/logo.jpg" id="logo">
                              <h4 class="modal-title" id="myModalLabel">Create A Postcard</h4>
                            </header>
                              <div class="modal-body">
                               <form action='/postcard' method="POST" enctype="multipart/form-data">
                                    <p><input type='file' name='passportpic' multiple=''>
                                <input type='submit' value='upload'>
                                    </p>
                                </form> -->

                             <!--  </div> -->
                              <!--end modal body-->
                     <!--    </div> -->
                 <!--      </div> -->
                      <!--end modal content-->
                   <!--  </div> -->
                    <!--end modal window-->


    <!--SEECOND COL IN THE FIRST CONTAINER-->

                    <div class="media-body">
                    <div class="col-md-7">
                    <center><h3>My Passport</h3></center>
                    <table class="table">
                    <tbody>
                    <thead>
                        <tr>
                        <th data-field="states">Countries</th>
                        <th data-field="states">States</th>
                        <th data-field="capitols">Capitols</th>
                        <th data-field="landmark">Landmarks</th>
                        <th data-field="landmark">Wonders</th>
                    <!--<th data-field="cities">Citites</th>-->
                        </tr>
                     </thead>
                    </tbody>
                            <tr>
                            <td>5</td>
                            <td>15</td>
                            <td>21</td>
                            <td>14</td>
                            </tr>
                    </table>
                    </div>
               </div>
            </div>
        </div>







    <!--SEECOND COL IN THE FIRST CONTAINER-->
    <div class="container-fluid" id="postcards">
      <div class="row">
        <div class="col-xs-12 col-md-8">
            <div class="row">
              <div class="col-md-7">
                <div class="well well-sm">
                  <div class="media">
                    <center><a class="thumbnail center" href="#">
                        <img class="media-object" src="static/img/dashboard.jpg">
                        </a></center>
                          <div class="media-body">
                            <div class="col-md-8">
                              <center><h3>My Postcards</h3></center>
                                    <form action='/postcard' method="POST" enctype="multipart/form-data">
                                      <p><input type='file' name='postcard' multiple=''>
                                      <input type='submit' value='upload'></p>
                                    </form>
                            </div>
                          </div>
                    </div>
                  </div>
              </div>
          </div>
      </div>
    </div>
</div>



<form action="dashboard">
  <label for="" class="">
    Dashboard
  </label>

<div class="ui-widget input">
      <label for="location">Landmarks</label>
  <input type="text" id="location" class="input" placeholder="landmarks" required>
</div>

<div class="ui-widget input">
      <label for="location">Wonders</label>
  <input type="text" id="location" class="input" placeholder="wonders" required>
</div>

<div class="ui-widget input">
      <label for="location">Cities</label>
  <input type="text" id="location" class="input" placeholder="cities" required>
</div>

<div class="ui-widget input">
      <label for="location">Capitals</label>
  <input type="text" id="location" class="input" placeholder="state capitals" required>
</div>

<div class="ui-widget input">
      <label for="location">Undiscovered</label>
  <input type="text" id="location" class="input" placeholder="undiscovered" required>
</div>

  <div class="col-sm-offset-2 col-sm-10">
    <button type="submit" class="btn btn-default">Update</button>
  </div>

</form>


</script>




<script>
  //location autofill
$(function() {
    // assigned var places to empty list
   var places = [];
      // jinja for place in places
       {% for location in locations %}
        // added new list item to end of the array
     places.push("{{location.location}}");
       {% endfor %}
       // autocomplete #location
$( "#location" ).autocomplete({
 source: availableTags
});
});
</script>

AIzaSyACeycrJBhijX_wyuGd8cGqo8VUIfT2Aww




          <td class="label">Description</td>
        <td class="wideField" colspan="3">
        <textarea class="class="field"" rows="3" id="country"></textarea>
      </td>
      </tr>
      <div id="locationField">
      <input id="autocomplete" placeholder="Enter your address"
             onFocus="geolocate()" type="text"></input>
    </div>

    <table id="address">
      <tr>
        <td class="label">Street address</td>
        <td class="slimField"><input class="field" id="street_number"
              disabled="true"></input></td>
        <td class="wideField" colspan="2"><input class="field" id="route"
              disabled="true"></input></td>
      </tr>
      <tr>
        <td class="label">City</td>
        <td class="wideField" colspan="3"><input class="field" id="locality"
              disabled="true"></input></td>
      </tr>
      <tr>
        <td class="label">State</td>
        <td class="slimField"><input class="field"
              id="administrative_area_level_1" disabled="true"></input></td>
        <td class="label">Zip code</td>
        <td class="wideField"><input class="field" id="postal_code"
              disabled="true"></input></td>
      </tr>
      <tr>
        <td class="label">Country</td>
        <td class="wideField" colspan="3"><input class="field"
              id="country" disabled="true"></input></td>
      </tr>
    </table>









{% endblock %}

{% block footer %}
{% endblock %}








